<form [formGroup]="patientForm" (ngSubmit)="onSubmit()" class="patient-form">
  <!-- Personal Information Section -->
  <div class="form-section">
    <h3>Personal Information</h3>
    
    <div class="form-row">
      <div class="form-group">
        <label for="fullName">Full Name *</label>
        <input 
          type="text" 
          id="fullName" 
          formControlName="fullName"
          class="form-control"
          [class.error]="isFieldInvalid('personalInfo.fullName')"
          placeholder="Enter patient's full name">
        <div class="error-message" *ngIf="isFieldInvalid('personalInfo.fullName')">
          {{ getFieldError('personalInfo.fullName') }}
        </div>
      </div>

      <div class="form-group">
        <label for="gender">Gender *</label>
        <select 
          id="gender" 
          formControlName="gender"
          class="form-control"
          [class.error]="isFieldInvalid('personalInfo.gender')">
          <option value="">Select Gender</option>
          <option *ngFor="let option of genderOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
        <div class="error-message" *ngIf="isFieldInvalid('personalInfo.gender')">
          {{ getFieldError('personalInfo.gender') }}
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="age">Age *</label>
        <input 
          type="number" 
          id="age" 
          formControlName="age"
          class="form-control"
          [class.error]="isFieldInvalid('personalInfo.age')"
          placeholder="Enter age"
          min="0" max="120">
        <div class="error-message" *ngIf="isFieldInvalid('personalInfo.age')">
          {{ getFieldError('personalInfo.age') }}
        </div>
      </div>

      <div class="form-group">
        <label for="phoneNumber">Phone Number *</label>
        <input 
          type="tel" 
          id="phoneNumber" 
          formControlName="phoneNumber"
          class="form-control"
          [class.error]="isFieldInvalid('personalInfo.phoneNumber')"
          placeholder="Enter phone number">
        <div class="error-message" *ngIf="isFieldInvalid('personalInfo.phoneNumber')">
          {{ getFieldError('personalInfo.phoneNumber') }}
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="dateOfBirth">Date of Birth *</label>
      <input 
        type="date" 
        id="dateOfBirth" 
        formControlName="dateOfBirth"
        class="form-control"
        [class.error]="isFieldInvalid('personalInfo.dateOfBirth')">
      <div class="error-message" *ngIf="isFieldInvalid('personalInfo.dateOfBirth')">
        {{ getFieldError('personalInfo.dateOfBirth') }}
      </div>
    </div>

    <div class="form-group">
      <label for="address">Address *</label>
      <textarea 
        id="address" 
        formControlName="address"
        class="form-control"
        [class.error]="isFieldInvalid('personalInfo.address')"
        placeholder="Enter patient's address"
        rows="3"></textarea>
      <div class="error-message" *ngIf="isFieldInvalid('personalInfo.address')">
        {{ getFieldError('personalInfo.address') }}
      </div>
    </div>
  </div>

  <!-- Category Section -->
  <div class="form-section">
    <h3>Patient Category</h3>
    
    <div class="form-group">
      <label for="category">Category *</label>
      <select 
        id="category" 
        formControlName="category"
        class="form-control"
        [class.error]="isFieldInvalid('category')">
        <option value="">Select Category</option>
        <option *ngFor="let option of categoryOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
      <div class="error-message" *ngIf="isFieldInvalid('category')">
        {{ getFieldError('category') }}
      </div>
    </div>
  </div>

  <!-- Pregnancy Details Section (Conditional) -->
  <div class="form-section" *ngIf="showPregnancySection()" formGroupName="pregnancyDetails">
    <h3>Pregnancy Details</h3>
    
    <div class="form-row">
      <div class="form-group">
        <label for="lmpDate">Last Menstrual Period (LMP) *</label>
        <input 
          type="date" 
          id="lmpDate" 
          formControlName="lmpDate"
          class="form-control"
          [class.error]="isFieldInvalid('pregnancyDetails.lmpDate')">
        <div class="error-message" *ngIf="isFieldInvalid('pregnancyDetails.lmpDate')">
          {{ getFieldError('pregnancyDetails.lmpDate') }}
        </div>
      </div>

      <div class="form-group">
        <label for="edd">Expected Due Date (EDD) *</label>
        <input 
          type="date" 
          id="edd" 
          formControlName="edd"
          class="form-control"
          [class.error]="isFieldInvalid('pregnancyDetails.edd')">
        <div class="error-message" *ngIf="isFieldInvalid('pregnancyDetails.edd')">
          {{ getFieldError('pregnancyDetails.edd') }}
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="pregnancyWeek">Pregnancy Week</label>
        <input 
          type="number" 
          id="pregnancyWeek" 
          formControlName="pregnancyWeek"
          class="form-control"
          placeholder="Current week">
      </div>

      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input type="checkbox" formControlName="highRisk">
          High Risk Pregnancy
        </label>
      </div>
    </div>

    <div class="form-group">
      <label for="pregnancyNotes">Pregnancy Notes</label>
      <textarea 
        id="pregnancyNotes" 
        formControlName="notes"
        class="form-control"
        placeholder="Add pregnancy-related notes"
        rows="3"></textarea>
    </div>
  </div>

  <!-- Medical Information Section -->
  <div class="form-section" formGroupName="medicalInfo">
    <h3>Medical Information</h3>
    
    <div class="form-row">
      <div class="form-group">
        <label for="bloodGroup">Blood Group</label>
        <select 
          id="bloodGroup" 
          formControlName="bloodGroup"
          class="form-control">
          <option value="">Select Blood Group</option>
          <option *ngFor="let option of bloodGroupOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="allergies">Allergies</label>
      <textarea 
        id="allergies" 
        formControlName="allergies"
        class="form-control"
        placeholder="List allergies (one per line)"
        rows="2"></textarea>
      <small class="help-text">Enter one allergy per line</small>
    </div>

    <div class="form-group">
      <label for="chronicConditions">Chronic Conditions</label>
      <textarea 
        id="chronicConditions" 
        formControlName="chronicConditions"
        class="form-control"
        placeholder="List chronic conditions (one per line)"
        rows="2"></textarea>
      <small class="help-text">Enter one condition per line</small>
    </div>

    <div class="form-group">
      <label for="currentMedications">Current Medications</label>
      <textarea 
        id="currentMedications" 
        formControlName="currentMedications"
        class="form-control"
        placeholder="List current medications (one per line)"
        rows="2"></textarea>
      <small class="help-text">Enter one medication per line</small>
    </div>

    <div class="form-group">
      <label for="medicalHistory">Medical History</label>
      <textarea 
        id="medicalHistory" 
        formControlName="medicalHistory"
        class="form-control"
        placeholder="Add medical history details"
        rows="4"></textarea>
    </div>

    <div class="form-group">
      <label for="medicalNotes">Special Notes</label>
      <textarea 
        id="medicalNotes" 
        formControlName="notes"
        class="form-control"
        placeholder="Add special details if any"
        rows="3"></textarea>
    </div>
  </div>

  <!-- Emergency Contact Section -->
  <div class="form-section">
    <h3>Emergency Contact</h3>
    
    <div class="form-row">
      <div class="form-group">
        <label for="emergencyContact">Emergency Contact Name</label>
        <input 
          type="text" 
          id="emergencyContact" 
          formControlName="emergencyContact"
          class="form-control"
          placeholder="Emergency contact person name">
      </div>

      <div class="form-group">
        <label for="emergencyPhone">Emergency Contact Phone</label>
        <input 
          type="tel" 
          id="emergencyPhone" 
          formControlName="emergencyPhone"
          class="form-control"
          placeholder="Emergency contact phone number">
      </div>
    </div>
  </div>

  <!-- Form Actions -->
  <div class="form-actions">
    <button 
      type="button" 
      class="btn btn-secondary" 
      (click)="onCancel()"
      [disabled]="isSubmitting">
      Cancel
    </button>
    
    <button 
      type="submit" 
      class="btn btn-primary" 
      [disabled]="isSubmitting || patientForm.invalid">
      {{ isSubmitting ? 'Saving...' : (isEditMode ? 'Update Patient' : 'Add Patient') }}
    </button>
  </div>
</form>